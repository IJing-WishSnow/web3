No contracts to compile
Running node:test tests


ğŸ“‹ Starting EventLog Tests


âœ… All EventLog tests completed successfully!

âœ“ TokenMinted event emitted correctly
  EventLog - Critical Event Emission Tests
    NFT Events
      âœ” Should emit TokenMinted event on mint (278ms)
âœ“ Transfer event emitted on mint
      âœ” Should emit Transfer event on mint (114ms)
âœ“ BaseURIUpdated event emitted
      âœ” Should emit BaseURIUpdated event (125ms)
âœ“ AuctionCreated event emitted with correct data
    Auction Events
      âœ” Should emit AuctionCreated event (471ms)
âœ“ NewBid event emitted with USD value: 600000000000
      âœ” Should emit NewBid event on ETH bid (520ms)
âœ“ NewBid event emitted for ERC20 bid
      âœ” Should emit NewBid event on ERC20 bid (646ms)
âœ“ AuctionEnded event: winner=0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC, fee=200bps
      âœ” Should emit AuctionEnded event with winner (558ms)
âœ“ AuctionCancelled event emitted for no bids
      âœ” Should emit AuctionCancelled event for no bids (445ms)
âœ“ AuctionCancelled event emitted on emergency
      âœ” Should emit AuctionCancelled on emergency cancel (419ms)
âœ“ FeeTiersUpdated event emitted
      âœ” Should emit FeeTiersUpdated event (215ms)
âœ“ PriceFeedUpdated event emitted
    PriceConsumer Events
      âœ” Should emit PriceFeedUpdated event (403ms)
âœ“ PriceUpdated event emitted: 300000000000
      âœ” Should emit PriceUpdated event on getLatestPrice (334ms)
âœ“ PriceFeedRequested event emitted
      âœ” Should emit PriceFeedRequested event (327ms)
âœ“ PriceFeedApproved event emitted
      âœ” Should emit PriceFeedApproved event (341ms)
âœ“ Multiple events: 1 Transfer + 1 AuctionCreated
    Multiple Events in Single Transaction
      âœ” Should emit multiple events on auction with bid (617ms)
âœ“ Auction end events: 1 Transfer + 1 AuctionEnded
      âœ” Should emit multiple events on auction end (484ms)


â¬†ï¸  Starting Upgradeability Tests


âœ… All Upgradeability tests completed successfully!

âœ“ New NFT implementation deployed
âœ“ NFT contract upgraded successfully
  Upgradeability - UUPS Proxy Upgrade Tests
    UUPS Upgrade Authorization
      âœ” Should allow owner to upgrade NFT contract (210ms)
âœ“ New PriceConsumer implementation deployed
âœ“ PriceConsumer upgraded successfully
      âœ” Should allow owner to upgrade PriceConsumer (238ms)
âœ“ New implementation deployed
âœ“ Auction contract upgraded
      âœ” Should allow owner to upgrade Auction contract (369ms)
âœ“ Non-owner upgrade rejected
      âœ” Should reject upgrade from non-owner (293ms)
âœ“ NFT minted before upgrade
âœ“ NFT contract upgraded
âœ“ NFT ownership preserved after upgrade
    State Preservation After Upgrade
      âœ” Should preserve NFT state after upgrade (320ms)
âœ“ Auction created before upgrade
âœ“ Contract upgraded
âœ“ Auction data preserved
      âœ” Should preserve auction data after upgrade (517ms)
âœ“ 3 auctions created
âœ“ Contract upgraded
âœ“ Auction count preserved: 3
      âœ” Should preserve auction count after upgrade (755ms)
âœ“ Contract upgraded
âœ“ Fee recipient preserved
      âœ” Should preserve fee settings after upgrade (398ms)
âœ“ Contract upgraded
âœ“ Auction created after upgrade
    Functionality After Upgrade
      âœ” Should allow creating auctions after upgrade (376ms)
âœ“ Auction created
âœ“ Contract upgraded
âœ“ Bid placed after upgrade
      âœ” Should allow bidding after upgrade (879ms)
âœ“ NFT contract upgraded
âœ“ NFT minted after upgrade
âœ“ NFT functionality works after upgrade
      âœ” Should allow NFT minting after upgrade (199ms)
âœ“ Implementation address verified
    Proxy Implementation Verification
      âœ” Should return correct implementation address (325ms)
âœ“ Implementation address updated after upgrade
      âœ” Should update implementation address after upgrade (490ms)
âœ“ First upgrade completed
âœ“ Second upgrade completed
âœ“ Contract still functional after 2 upgrades
    Multiple Upgrades
      âœ” Should handle multiple sequential upgrades (383ms)
âœ“ Contract upgraded
âœ“ Reinitialization prevented
    Reinitializer Protection
      âœ” Should prevent reinitialization after upgrade (308ms)


ğŸ§ª Starting AuctionERC20 Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
Seller: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
Bidder1: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
Bidder2: 0x90f79bf6eb2c4f870365e785982e1f101e93b906
Bidder3: 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
Fee Recipient: 0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc


âœ… All AuctionERC20 tests completed successfully!

âœ“ ERC20 auction setup complete
âœ“ Winning bid placed: 200000000000000000000 tokens
âœ“ Time advanced past auction end
âœ“ AuctionEnded event emitted
âœ“ Winner: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
âœ“ Amount: 200000000000000000000
âœ“ USD Value: $200
âœ“ Fee: 10000000000000000000 tokens
âœ“ Fee Rate: 500 bps
âœ“ NFT transferred to winner
âœ“ Seller received: 190000000000000000000 tokens
âœ“ Fee recipient received: 10000000000000000000 tokens
âœ“ Auction marked as ended
  AuctionERC20 - Complete ERC20 Payment Auction Flow Tests
    Complete ERC20 Auction Flow with Winner
      âœ” Should execute complete ERC20 auction flow: create -> bid -> end -> settle (1093ms)
âœ“ Bidder1 first bid: 150 tokens
âœ“ Bidder2 outbid: 200 tokens
âœ“ Bidder1 refunded successfully
âœ“ Bidder3 final bid: 250 tokens
âœ“ Bidder3 won the auction
      âœ” Should handle multiple ERC20 bids and refund correctly (1120ms)
âœ“ Expected fee: 30000000000000000000 tokens (300 bps)
âœ“ Fee calculation verified
âœ“ Fee recipient received correct amount: 30000000000000000000 tokens
      âœ” Should calculate and distribute ERC20 platform fee correctly (892ms)
âœ“ ERC20 auction created with no bids
âœ“ NFT in auction contract
âœ“ AuctionCancelled event emitted
âœ“ NFT returned to seller
    ERC20 Auction with No Bids
      âœ” Should return NFT to seller when ERC20 auction ends with no bids (667ms)
âœ“ Approved only 50 tokens
âœ“ Bidding prevented due to insufficient approval
    ERC20 Approval and Bidding
      âœ” Should NOT allow bidding without sufficient ERC20 approval (1245ms)
âœ“ Bidder1 has no tokens
âœ“ Bidding prevented due to insufficient balance
      âœ” Should NOT allow bidding without sufficient ERC20 balance (936ms)
âœ“ Approved exact bid amount: 150000000000000000000
âœ“ Bid placed successfully with exact approval
âœ“ Highest bid recorded: 150000000000000000000
      âœ” Should handle exact approval amount correctly (687ms)
âœ“ Bid amount: 1000000000000000000000 tokens
âœ“ Fee: 30000000000000000000 tokens
âœ“ Seller received: 970000000000000000000 tokens
âœ“ Expected seller amount: 970000000000000000000 tokens
âœ“ ERC20 payment distribution verified
    ERC20 Payment Distribution
      âœ” Should correctly split ERC20 payment between seller and platform (559ms)
âœ“ Created 3 ERC20 auctions
âœ“ Auction 0: Bid 200000000000000000000 tokens
âœ“ Auction 1: Bid 300000000000000000000 tokens
âœ“ Auction 2: Bid 400000000000000000000 tokens
âœ“ Auction 0 ended
âœ“ Auction 1 ended
âœ“ Auction 2 ended
âœ“ All NFTs transferred to correct winners
      âœ” Should handle multiple ERC20 auctions independently (888ms)
âœ“ ETH payment prevented for ERC20 auction
    Mixed Payment Types Validation
      âœ” Should NOT allow ETH payment for ERC20 auction (349ms)
âœ“ Payment token correctly set to: 0x5302E909d1e93e30F05B5D6Eea766363D14F9892
      âœ” Should verify payment token is correctly set (265ms)
âœ“ Auction created with 6-decimal token
âœ“ Bid placed with 6-decimal token: 200000000
âœ“ Auction ended successfully with 6-decimal token
    ERC20 Token Decimals Handling
      âœ” Should handle tokens with 6 decimals (like USDC) (302ms)
âœ“ 8-decimal token auction completed successfully
      âœ” Should handle tokens with 8 decimals (230ms)
âœ“ Bid placed
âœ“ AuctionCancelled event emitted
âœ“ Bidder refunded: 200000000000000000000 tokens
âœ“ NFT returned to seller
    ERC20 Emergency Cancellation
      âœ” Should allow owner to emergency cancel ERC20 auction and refund bidder (290ms)


ğŸ§ª Starting AuctionEth Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
Seller: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
Bidder1: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
Bidder2: 0x90f79bf6eb2c4f870365e785982e1f101e93b906
Bidder3: 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
Fee Recipient: 0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc


âœ… All AuctionEth tests completed successfully!

âœ“ Auction setup complete
âœ“ Winning bid placed: 2000000000000000000 wei
âœ“ Time advanced past auction end
âœ“ AuctionEnded event emitted
âœ“ Winner: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
âœ“ Amount: 2000000000000000000
âœ“ USD Value: $6000
âœ“ Fee: 60000000000000000 wei
âœ“ Fee Rate: 300 bps
âœ“ NFT transferred to winner
âœ“ Seller received: 1939757007530313836 wei
âœ“ Fee recipient received: 60000000000000000 wei
âœ“ Auction marked as ended
  AuctionEth - Complete ETH Payment Auction Flow Tests
    Complete Auction Flow with Winner
      âœ” Should execute complete auction flow: create -> bid -> end -> settle (752ms)
âœ“ Bidder1 first bid: 1.5 ETH
âœ“ Bidder2 outbid: 2 ETH
âœ“ Bidder3 final bid: 2.5 ETH
âœ“ Bidder1 refunded successfully
âœ“ Bidder3 won the auction
      âœ” Should handle multiple bids and refund correctly (799ms)
âœ“ Expected fee: 200000000000000000 wei (200 bps)
âœ“ Fee calculation verified
âœ“ Fee recipient received correct amount: 200000000000000000 wei
      âœ” Should calculate and distribute platform fee correctly (610ms)
âœ“ Auction created with no bids
âœ“ NFT in auction contract
âœ“ AuctionCancelled event emitted
âœ“ NFT returned to seller
âœ“ Auction marked as ended
    Auction with No Bids
      âœ” Should return NFT to seller when auction ends with no bids (536ms)
âœ“ AuctionCancelled event emitted for auction with no bids
      âœ” Should emit AuctionCancelled event with no winner (477ms)
âœ“ Bid placed
âœ“ Ending auction before time prevented as expected
    Auction Timing and Access Control
      âœ” Should NOT allow ending auction before time expires (430ms)
âœ“ Seller successfully ended auction
      âœ” Should allow seller to end auction after time expires (655ms)
âœ“ Owner successfully ended auction
      âœ” Should allow owner to end auction after time expires (881ms)
âœ“ Non-authorized user prevented from ending auction
      âœ” Should NOT allow non-seller/non-owner to end auction (687ms)
âœ“ Auction ended successfully
âœ“ Double-ending prevented as expected
      âœ” Should NOT allow ending already ended auction (529ms)
âœ“ Bid placed
âœ“ AuctionCancelled event emitted
âœ“ Bidder refunded: 2000000000000000000 wei
âœ“ NFT returned to seller
âœ“ Auction marked as ended
    Emergency Cancellation
      âœ” Should allow owner to emergency cancel active auction (476ms)
âœ“ Non-owner prevented from emergency cancel
      âœ” Should NOT allow non-owner to emergency cancel (324ms)
âœ“ Bid amount: 10000000000000000000 wei
âœ“ Fee: 200000000000000000 wei
âœ“ Seller received: 9799788774998521425 wei
âœ“ Expected seller amount: 9800000000000000000 wei
âœ“ Payment distribution verified
    Payment Distribution Verification
      âœ” Should correctly split payment between seller and platform (342ms)
âœ“ Created 3 auctions
âœ“ Auction 0: Bid 2000000000000000000 wei
âœ“ Auction 1: Bid 3000000000000000000 wei
âœ“ Auction 2: Bid 4000000000000000000 wei
âœ“ Auction 0 ended
âœ“ Auction 1 ended
âœ“ Auction 2 ended
âœ“ All NFTs transferred to correct winners
      âœ” Should handle multiple auctions independently (504ms)


ğŸ§ª Starting FeeSystem Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
Seller: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
Bidder1: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
Fee Recipient: 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65


âœ… All FeeSystem tests completed successfully!

âœ“ Default platform fee: 200 bps (2%)
  FeeSystem - Dynamic Fee Calculation Tests
    Default Fee Configuration
      âœ” Should initialize with default platform fee of 2% (386ms)
âœ“ Fee tier count: 4
      âœ” Should initialize with 4 fee tiers (242ms)
âœ“ Retrieved 4 fee tiers:
  Tier 1: $0 - $1,000 â†’ 5%
  Tier 2: $1,000 - $10,000 â†’ 3%
  Tier 3: $10,000 - $100,000 â†’ 2%
  Tier 4: $100,000+ â†’ 1%
      âœ” Should retrieve all fee tiers correctly (293ms)
âœ“ Minimum USD value: $10
      âœ” Should have correct minimum USD value ($10) (237ms)
âœ“ Bid: 0.1 ETH (~$300)
âœ“ Fee tier: 1 (5%)
âœ“ Fee: 5000000000000000 wei
    Fee Tier Testing
      âœ” Should use 5% fee for Tier 1 ($0 - $1,000) (490ms)
âœ“ Bid: 1 ETH (~$3,000)
âœ“ Fee tier: 2 (3%)
âœ“ Fee: 30000000000000000 wei
      âœ” Should use 3% fee for Tier 2 ($1,000 - $10,000) (448ms)
âœ“ Bid: 10 ETH (~$30,000)
âœ“ Fee tier: 3 (2%)
âœ“ Fee: 200000000000000000 wei
      âœ” Should use 2% fee for Tier 3 ($10,000 - $100,000) (489ms)
âœ“ Bid: 50 ETH (~$150,000)
âœ“ Fee tier: 4 (1%)
âœ“ Fee: 500000000000000000 wei
      âœ” Should use 1% fee for Tier 4 ($100,000+) (356ms)
âœ“ Bid: 0.015 ETH (~$45)
âœ“ Above $10 threshold: 500 bps (5%)
      âœ” Should use default fee for amounts below minimum USD (680ms)
âœ“ 0.333 ETH (~$999): 500 bps
âœ“ 0.334 ETH (~$1,002): 300 bps
    Fee Tier Boundary Testing
      âœ” Should handle tier boundaries correctly (1345ms)
âœ“ Custom tiers set: 2
    Custom Fee Configuration
      âœ” Should allow owner to set custom fee tiers (277ms)
âœ“ Non-owner prevented
      âœ” Should NOT allow non-owner to set tiers (240ms)
âœ“ Fee > 10% rejected
      âœ” Should reject fees > 10% (228ms)
âœ“ Expected: 100000000000000000 wei (2%)
âœ“ Actual fee matched expected
    Fee Integration
      âœ” Should apply correct fee in settlement (455ms)


ğŸ§ª Starting AuctionCore Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
Seller: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
Bidder1: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
Bidder2: 0x90f79bf6eb2c4f870365e785982e1f101e93b906
Bidder3: 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
Fee Recipient: 0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc


âœ… All AuctionCore tests completed successfully!

âœ“ NFT minted to seller
âœ“ NFT approved for auction contract
âœ“ Auction created with ID: 0
âœ“ Start price: 1000000000000000000 wei
âœ“ Auction data verified
  AuctionCore - Auction Creation and Basic Bidding Tests
    Auction Creation Tests
      âœ” Should create auction with ETH payment successfully (585ms)
âœ“ Zero price auction prevented as expected
      âœ” Should NOT allow creating auction with zero price (501ms)
âœ“ Short duration auction prevented as expected
      âœ” Should NOT allow creating auction with duration too short (388ms)
âœ“ Long duration auction prevented as expected
      âœ” Should NOT allow creating auction with duration too long (461ms)
âœ“ NFT minted but NOT approved
âœ“ Auction without approval prevented as expected
      âœ” Should NOT allow creating auction without NFT approval (384ms)
âœ“ Initial auction count: 0
âœ“ Auction count after 3 auctions: 3
      âœ” Should increment auction counter correctly (644ms)
âœ“ Auction created
âœ“ Bid placed: 1500000000000000000 wei
âœ“ USD value: $4500
âœ“ Highest bidder updated to: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
    ETH Bidding Tests
      âœ” Should allow bidding with ETH successfully (497ms)
âœ“ First bid placed by bidder1: 1500000000000000000
âœ“ Second bid placed by bidder2: 2000000000000000000
âœ“ Previous bidder refunded successfully
âœ“ Highest bidder updated to bidder2
      âœ” Should refund previous bidder when outbid (416ms)
âœ“ First bid: 2 ETH
âœ“ Lower bid prevented as expected
      âœ” Should NOT allow bid lower than highest bid (916ms)
âœ“ Equal bid prevented as expected
      âœ” Should NOT allow bid equal to highest bid (710ms)
âœ“ Bid 1: 1500000000000000000 wei
âœ“ Bid 2: 2000000000000000000 wei
âœ“ Bid 3: 2500000000000000000 wei
âœ“ Bid 4: 3000000000000000000 wei
âœ“ Bid 5: 3500000000000000000 wei
âœ“ Final highest bidder: 0x90F79bf6EB2c4f870365E785982E1f101E93b906
âœ“ Final highest bid: 3500000000000000000
      âœ” Should allow multiple sequential bids (668ms)
âœ“ Active auctions: 3
âœ“ Auction IDs: 0, 1, 2
    Auction State Management
      âœ” Should track active auctions correctly (645ms)
âœ“ Seller: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
âœ“ NFT Contract: 0xAA292E8611aDF267e563f334Ee42320aC96D0463
âœ“ Token ID: 40
âœ“ Start Price: 2500000000000000000
âœ“ Ended: false
      âœ” Should retrieve auction details correctly (264ms)
âš  Note: Contract may allow seller to bid (check business logic)
    Edge Cases and Error Handling
      âœ” Should NOT allow seller to bid on own auction (262ms)
âœ“ Zero address NFT contract prevented as expected
      âœ” Should handle zero address validations (223ms)

Using deployer: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
User1: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
User2: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
âœ“ Implementation deployed at: 0x5fbdb2315678afecb367f032d93f642f64180aa3
âœ“ Contract bytecode exists (length: 35634)
  Core Contract Deployment Tests
    PriceConsumer - Deployment and Initialization
      âœ” Should deploy implementation contract successfully (without initialization) (152ms)
âœ“ Owner on uninitialized implementation: 0x0000000000000000000000000000000000000000
âœ“ This is expected - implementation is not initialized
      âœ” Should NOT be able to read state from uninitialized implementation (86ms)
âœ“ Implementation deployed at: 0x9fe46736679d2d9a65f0992f2272de9f3c7fa6e0
âœ“ Proxy deployed at: 0xcf7ed3acca5a467e9e704c703e8d87f634fb0fc9
âœ“ Version: PriceConsumer v1.0.0
âœ“ Owner correctly initialized: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
âœ“ ETH price feed initialized correctly
      âœ” Should deploy with proxy and initialize correctly (123ms)
âœ“ Re-initialization prevented as expected
      âœ” Should NOT allow re-initialization after proxy initialization (119ms)
âœ“ Implementation deployed at: 0x0165878a594ca255338adfa4d48449f69242eb8f
âœ“ Contract bytecode exists
    NFTERC721 - Deployment and Initialization
      âœ” Should deploy implementation contract successfully (without initialization)
âœ“ Name on uninitialized implementation: ""
âœ“ Empty/default value expected for uninitialized contract
      âœ” Should NOT be able to use uninitialized implementation
âœ“ Implementation deployed at: 0x2279b7a0a67db372996a5fab50d91eaa73d2ebe6
âœ“ Proxy deployed at: 0x8a791620dd6260079bf849dc5567adc3f2fdc318
âœ“ Name: TestNFT
âœ“ Symbol: TNFT
âœ“ Version: v1.0.0
âœ“ Owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
      âœ” Should deploy with proxy and initialize correctly (115ms)
âœ“ Re-initialization prevented as expected
      âœ” Should NOT allow re-initialization (146ms)
âœ“ Implementation deployed at: 0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0
âœ“ Contract bytecode exists
    NFTAuction - Deployment and Initialization
      âœ” Should deploy implementation contract successfully (without initialization)
âœ“ PriceConsumer deployed
âœ“ NFTAuction implementation deployed
âœ“ NFTAuction proxy deployed
âœ“ Owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
âœ“ Fee recipient: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
âœ“ PriceConsumer: 0x9A676e781A523b5d0C0e43731313A708CB607508
âœ“ Default fee: 200 bps
âœ“ Auction count: 0
âœ“ Fee tiers: 4
      âœ” Should deploy with proxy and initialize correctly (236ms)
âœ“ Re-initialization prevented as expected
      âœ” Should NOT allow re-initialization (193ms)

âœ… All contracts deployed and initialized successfully:
   PriceConsumer: 0x4ed7c70f96b99c776995fb64377f0d4ab3b0e1c1 (vPriceConsumer v1.0.0)
   NFTERC721: 0xa85233c63b9ee964add6f2cffe00fd84eb32338f (vv1.0.0)
   NFTAuction: 0x7a2088a1bfc9d81c55368ae168c2c02570cb814f (owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266)
    Integration - All Contracts Deployment
      âœ” Should deploy and initialize all three contracts with proper dependencies (333ms)


ğŸ§ª Starting NFTERC721 Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
User1: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
User2: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
User3: 0x90f79bf6eb2c4f870365e785982e1f101e93b906


âœ… All NFTERC721 tests completed successfully!

âœ“ Mint transaction confirmed: 0x3269edc91139b01a577113a9b10c2a0dcad6d542c3ac14bc841d476a487571af
âœ“ TokenMinted event emitted correctly
âœ“ Token owner: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
âœ“ User1 balance: 1
  NFTERC721 - NFT Minting and Transfer Tests
    NFT Minting Tests
      âœ” Should mint NFT successfully and emit TokenMinted event (298ms)
âœ“ User2 successfully minted NFT for user3
âœ“ Token ownership confirmed: 0x90F79bf6EB2c4f870365E785982E1f101E93b906
      âœ” Should allow anyone to mint (no access control) (116ms)
âœ“ First mint successful
âœ“ Duplicate minting prevented as expected
      âœ” Should NOT allow minting same tokenId twice (163ms)
âœ“ User1 balance after 3 mints: 3
      âœ” Should increment balance correctly after multiple mints (193ms)
âœ“ TokenId 0 URI: ipfs://bafybeie6fvm4v775pwd37dc3jzy462cjyxvy3wvjvxx55g4rh2cp2aa62i/bubuyier.json
    Token URI Functionality Tests
      âœ” Should return correct URI for tokenId 0 (special case) (172ms)
âœ“ TokenId 1 URI: ipfs://bafybeie6fvm4v775pwd37dc3jzy462cjyxvy3wvjvxx55g4rh2cp2aa62i/bubuyier.json
      âœ” Should return correct URI for tokenId 1 (special case) (139ms)
âœ“ TokenId 2 URI: ipfs://bafybeie6fvm4v775pwd37dc3jzy462cjyxvy3wvjvxx55g4rh2cp2aa62i/bubuyier2.json
      âœ” Should return correct URI for tokenId 2 (sequential naming) (120ms)
âœ“ TokenId 10 URI: ipfs://bafybeie6fvm4v775pwd37dc3jzy462cjyxvy3wvjvxx55g4rh2cp2aa62i/bubuyier10.json
âœ“ TokenId 999 URI: ipfs://bafybeie6fvm4v775pwd37dc3jzy462cjyxvy3wvjvxx55g4rh2cp2aa62i/bubuyier999.json
      âœ” Should return correct URI for higher tokenIds (185ms)
âœ“ TokenURI query reverted for non-existent token as expected
      âœ” Should revert when querying URI for non-existent token (115ms)
âœ“ Original URI: ipfs://original/bubuyier5.json
âœ“ BaseURIUpdated event emitted
âœ“ Updated URI: ipfs://updated/bubuyier5.json
      âœ” Should reflect new base URI after update (208ms)
âœ“ Base URI updated by owner
    Base URI Management
      âœ” Should allow owner to update base URI (120ms)
âœ“ Non-owner prevented from updating base URI as expected
      âœ” Should NOT allow non-owner to update base URI (111ms)
âœ“ Token minted to user1
âœ“ Transfer event emitted correctly
âœ“ Token transferred to user2: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
âœ“ Balances updated correctly: user1=0, user2=1
    NFT Transfer Tests
      âœ” Should transfer NFT using transferFrom (181ms)
âœ“ Safe transfer completed
âœ“ Token safely transferred to user2
      âœ” Should transfer NFT using safeTransferFrom (168ms)
âœ“ Unauthorized transfer prevented as expected
      âœ” Should NOT allow unauthorized transfer (159ms)
âœ“ Approval event emitted
âœ“ User2 approved for token: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
âœ“ Approved user successfully transferred token
    Approval and Operator Tests
      âœ” Should approve address and allow transfer (232ms)
âœ“ ApprovalForAll event emitted
âœ“ User2 is approved for all of user1's tokens
âœ“ Operator successfully transferred token using approval for all
      âœ” Should set approval for all and allow transfers (235ms)
âœ“ Name: MyAwesomeNFT
âœ“ Symbol: MANFT
    Query and Utility Functions
      âœ” Should return correct name and symbol (102ms)
âœ“ Token 123 does not exist: false
âœ“ Token 123 now exists: true
      âœ” Should correctly check token existence (163ms)
âœ“ Version: v1.0.0
      âœ” Should return correct version
âœ“ getNextTokenId message: Token ID tracking not implemented in this version
      âœ” Should return placeholder message for getNextTokenId
âœ“ Initial balance: 0
âœ“ Balance after minting 5 tokens: 5
      âœ” Should return correct balance for multiple tokens (217ms)
âœ“ Successfully minted 10 tokens to same address, balance: 10
    Edge Cases and Error Handling
      âœ” Should handle minting to same address multiple times (496ms)
âœ“ Token minted to user1
âœ“ Token transferred from user1 to user2
âœ“ Token transferred from user2 to user3
âœ“ Token transferred from user3 back to user1
âœ“ Token returned to original owner: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
      âœ” Should handle transfers between multiple parties (459ms)


ğŸ§ª Starting PriceConsumer Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
User1: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
User2: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc


âœ… All PriceConsumer tests completed successfully!

âœ“ Mock price feed deployed at: 0x5fbdb2315678afecb367f032d93f642f64180aa3
âœ“ PriceConsumer deployed at: 0xcf7ed3acca5a467e9e704c703e8d87f634fb0fc9
âœ“ Version: PriceConsumer v1.0.0
âœ“ ETH price feed initialized: true
âœ“ Owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
  PriceConsumer - Chainlink Price Query and USD Calculation Tests
    Deployment and Initialization
      âœ” Should deploy and initialize with ETH price feed (264ms)
âœ“ Re-initialization prevented as expected
      âœ” Should NOT allow re-initialization (201ms)
âœ“ PriceFeedUpdated event emitted
âœ“ Price feed set for token: 0x1234567890123456789012345678901234567890
    Price Feed Management
      âœ” Should allow owner to set price feed for a token (343ms)
âœ“ Batch price feeds set for 3 tokens
âœ“ All 3 price feeds verified
      âœ” Should allow batch setting price feeds (241ms)
âœ“ Batch setting reverted with mismatched arrays as expected
      âœ” Should revert batch setting with mismatched array lengths (193ms)
âœ“ Price feed set for token
âœ“ Price feed removed for token
      âœ” Should allow owner to remove price feed (239ms)
âœ“ Non-owner prevented from setting price feed as expected
      âœ” Should NOT allow non-owner to set price feed (170ms)
âœ“ PriceUpdated event emitted
âœ“ Latest ETH price: 300000000000
    Chainlink Price Query Tests
      âœ” Should get latest price for ETH (204ms)
âœ“ Raw price: 300000000000
âœ“ Decimals: 8
âœ“ Description: ETH / USD
      âœ” Should get price data with decimals and description (124ms)
âœ“ Normalized price (18 decimals): 3000000000000000000000
âœ“ Price in ETH format: $3000.00
      âœ” Should get normalized price (18 decimals) (191ms)
âœ“ Description: ETH / USD
âœ“ Decimals: 8
âœ“ Aggregator version: 4
      âœ” Should get price feed info (134ms)
âœ“ Query reverted for non-set price feed as expected
      âœ” Should revert when querying price for non-set feed (154ms)
âœ“ 1 ETH = $3000 USD (8 decimals)
    USD Price Calculation Tests
      âœ” Should calculate USD value for ETH amount (146ms)
âœ“ 0.1 ETH = $300 USD
âœ“ 0.5 ETH = $1500 USD
âœ“ 1 ETH = $3000 USD
âœ“ 2 ETH = $6000 USD
âœ“ 10 ETH = $30000 USD
      âœ” Should calculate USD value for different ETH amounts (140ms)
âœ“ 1 token (6 decimals) = $3000 USD
âœ“ 1 token (18 decimals) = $3000 USD
      âœ” Should calculate USD value with different token decimals (151ms)
âœ“ Consistent USD value: $3000
      âœ” Should return consistent USD calculations (375ms)
âœ“ Price feed requested by user: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
âœ“ Token: 0x1000000000000000000000000000000000000001
âœ“ Symbol: TEST
    Price Feed Request System
      âœ” Should allow users to request price feed for a token (350ms)
âœ“ Request prevented for already set price feed as expected
      âœ” Should NOT allow requesting price feed for already set token (265ms)
âœ“ User requested price feed
âœ“ PriceFeedApproved event emitted
âœ“ Price feed approved and set for token
      âœ” Should allow owner to approve price feed request (414ms)
âœ“ ETH price feed is set: true
âœ“ Random token is not set: false
    Query and Utility Functions
      âœ” Should correctly check if price feed is set (331ms)
âœ“ Version: PriceConsumer v1.0.0
      âœ” Should return correct version (133ms)
âœ“ Price feed set for USDC
âœ“ Price feed set for USDT
âœ“ Price feed set for DAI
âœ“ All 3 tokens have price feeds configured
âœ“ 100 USDC = $300000 USD
âœ“ 100 USDT = $300000 USD
âœ“ 100 DAI = $300000 USD
    Integration with Multiple Price Feeds
      âœ” Should manage multiple token price feeds correctly (339ms)


ğŸ”— Starting Integration Tests


âœ… All Integration tests completed successfully!

âœ“ NFT minted
âœ“ Auction created
âœ“ Bid 1: 2 ETH
âœ“ Bid 2: 3 ETH
âœ“ Bid 3: 5 ETH (winner)
âœ“ Auction ended
âœ“ NFT transferred to winner
  Integration - End-to-End Flow Tests
    Complete ETH Auction Flow
      âœ” Should execute full auction lifecycle with ETH (1087ms)
âœ“ Price feed set
âœ“ Tokens minted to bidders
âœ“ Auction created
âœ“ Bid 1: 200 tokens
âœ“ Bid 2: 500 tokens (winner)
âœ“ Auction ended
âœ“ NFT transferred to winner
    Complete ERC20 Auction Flow
      âœ” Should execute full auction lifecycle with ERC20 (1147ms)
âœ“ 3 auctions created
âœ“ Bids placed on all auctions
âœ“ All 3 auctions active
    Multiple Concurrent Auctions
      âœ” Should handle multiple auctions simultaneously (746ms)
âœ“ Bid: 1 ETH (~$3000)
âœ“ Fee tier: 3% (Tier 2)
    Price Feed Integration
      âœ” Should calculate fees based on USD value (353ms)
âœ“ Seller1 auction created
âœ“ Seller2 auction created
âœ“ Bidders participated
âœ“ 2 total auctions
    Multi-User Interaction
      âœ” Should handle multiple sellers and bidders (410ms)
âœ“ Platform fee received: 200000000000000000 wei
    Fee Distribution
      âœ” Should distribute fees correctly to platform (299ms)
âœ“ Auction created with bid
âœ“ Emergency cancelled
âœ“ NFT returned to seller
âœ“ Bidder refunded
    Emergency Scenarios
      âœ” Should handle emergency cancellation properly (238ms)
âœ“ 6-decimal token price feed set
âœ“ 8-decimal token price feed set
âœ“ Auction created with 6-decimal token
    Token Decimals Handling
      âœ” Should handle different token decimals correctly (467ms)


ğŸ› ï¸ Starting ErrorRecovery Tests


âœ… All ErrorRecovery tests completed successfully!

âœ“ Zero start price rejected
  ErrorRecovery - Exception Handling Tests
    Invalid Auction Creation
      âœ” Should reject auction with zero start price (242ms)
âœ“ Too short duration rejected
      âœ” Should reject auction with too short duration (360ms)
âœ“ Too long duration rejected
      âœ” Should reject auction with too long duration (210ms)
âœ“ No approval rejected
      âœ” Should reject auction without NFT approval (145ms)
âœ“ Non-existent NFT rejected
      âœ” Should reject auction with non-existent NFT (129ms)
âœ“ Auction starts immediately - test skipped
    Invalid Bidding Scenarios
      âœ” Should reject bid before auction starts (155ms)
âœ“ Bid after end rejected
      âœ” Should reject bid after auction ends (185ms)
âœ“ Low bid rejected
      âœ” Should reject bid lower than current highest (165ms)
âœ“ ETH for ERC20 auction rejected
      âœ” Should reject ETH bid for ERC20 auction (192ms)
âœ“ Insufficient balance rejected
      âœ” Should reject ERC20 bid without sufficient balance (174ms)
âœ“ No ERC20 approval rejected
      âœ” Should reject ERC20 bid without approval (202ms)
âœ“ Early end rejected
    Invalid Auction Ending
      âœ” Should reject ending auction before time (149ms)
âœ“ Double end rejected
      âœ” Should reject ending already ended auction (176ms)
âœ“ Unauthorized end rejected
      âœ” Should reject unauthorized user ending auction (170ms)
âœ“ Emergency cancel with no bids successful
    Emergency Cancel Scenarios
      âœ” Should handle emergency cancel with no bids (150ms)
âœ“ Emergency cancel with refund successful
      âœ” Should handle emergency cancel with active bid (184ms)
âœ“ Cancel of ended auction rejected
      âœ” Should reject emergency cancel of already ended auction (152ms)
âœ“ Minimum duration (1 minute) accepted
    Edge Cases
      âœ” Should handle auction with exact minimum duration (139ms)
âœ“ Maximum duration (30 days) accepted
      âœ” Should handle auction with exact maximum duration (143ms)
âœ“ Self-outbid attempt rejected
      âœ” Should handle multiple consecutive bids from same user (262ms)


ğŸ”’ Starting Security Tests
Owner: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
Seller: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8
Bidder1: 0x3c44cdddb6a900fa2b585dd299e03d12fa4293bc
Attacker: 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65


âœ… All Security tests completed successfully!

âœ“ Reentrancy guard prevented invalid state
  Security - Reentrancy and Access Control Tests
    Reentrancy Protection
      âœ” Should prevent reentrancy in bid function (225ms)
âœ“ EndAuction executed safely with reentrancy protection
      âœ” Should prevent reentrancy in endAuction function (207ms)
âœ“ Refund executed safely: 1000000000000000000 wei received
      âœ” Should handle refunds safely without reentrancy (171ms)
âœ“ Owner successfully updated fee recipient
    Access Control - Owner Functions
      âœ” Should allow only owner to set fee recipient (89ms)
âœ“ Non-owner prevented from setting fee recipient
      âœ” Should NOT allow non-owner to set fee recipient (112ms)
âœ“ Owner successfully set custom fee tiers
      âœ” Should allow only owner to set fee tiers (105ms)
âœ“ Non-owner prevented from setting fee tiers
      âœ” Should NOT allow non-owner to set fee tiers (84ms)
âœ“ Owner successfully emergency cancelled auction
      âœ” Should allow owner to emergency cancel auction (174ms)
âœ“ Non-owner prevented from emergency cancelling
      âœ” Should NOT allow non-owner to emergency cancel (161ms)
âœ“ NFT owner successfully created auction
    Access Control - NFT Ownership
      âœ” Should only allow NFT owner to create auction (134ms)
âœ“ Non-owner prevented from creating auction with others' NFT
      âœ” Should NOT allow non-owner to create auction with others NFT (113ms)
âœ“ Seller successfully ended their auction
      âœ” Should only allow seller to end their auction (196ms)
âœ“ Non-seller prevented from ending others' auction
      âœ” Should NOT allow others to end someone else's auction (262ms)
âœ“ Zero address rejected for fee recipient
    Input Validation
      âœ” Should reject zero address as fee recipient (122ms)
âœ“ Invalid duration rejected
      âœ” Should reject invalid auction duration (118ms)
âœ“ Low bid rejected
      âœ” Should reject bids lower than start price (148ms)


  190 passing (23102ms)


| Coverage Report                                     |        |             |                                                                                |                                                                                  |
| --------------------------------------------------- | ------ | ----------- | ------------------------------------------------------------------------------ | -------------------------------------------------------------------------------- |
| File Path                                           | Line % | Statement % | Uncovered Lines                                                                | Partially Covered Lines                                                          |
| contracts\Counter.sol                               | 0.00   | 0.00        | 10-11, 15-17                                                                   | -                                                                                |
| contracts\jobOne\JobOne.sol                         | 0.00   | 0.00        | 10, 14-15, 21-24, 33, 38-41, 47, 56-63, 70-120, 127-144, 151-158, 169-200,â€¦    | 21-23, 38-40, 59-61, 70-72, 130-142, 151-157, 177-186, 188-192, 194-198, 214-224 |
| contracts\jobThree\Mock\MockAggregatorV3.sol        | 100.00 | 100.00      | -                                                                              | -                                                                                |
| contracts\jobThree\Mock\MockERC20.sol               | 75.00  | 75.00       | 53                                                                             | -                                                                                |
| contracts\study\ReentrancyAttack.sol                | 0.00   | 0.00        | 10, 15-22, 27, 36, 41-43, 48-50, 55, 64, 68-74, 78, 89-95, 99, 104-110, 114    | 41-43                                                                            |
| contracts\study\Timelock.sol                        | 0.00   | 0.00        | 53-56, 61-64, 68-69, 73-74, 94-112, 127-141, 159-212, 219, 232-233             | 53-55, 61-63, 95-97, 128-130, 161-163, 165-167, 169-174, 185-193, 199-201        |
| contracts\jobTwo\Begging.sol                        | 0.00   | 0.00        | 20, 28-29, 46-53, 63-64, 74, 83                                                | -                                                                                |
| contracts\jobTwo\SimpleERC20.sol                    | 0.00   | 0.00        | 44-45, 61-67, 75, 84-85, 94-95, 107, 121-132, 141, 148-160, 167-171, 178-186,â€¦ | 128, 156-157, 182                                                                |
| contracts\study\ABIEncode.sol                       | 0.00   | 0.00        | 11, 15, 19-25, 29-35, 50-53                                                    | -                                                                                |
| contracts\study\Faucet.sol                          | 0.00   | 0.00        | 13, 17-29                                                                      | -                                                                                |
| contracts\study\PriceConsumer.sol                   | 0.00   | 0.00        | 11, 15-23                                                                      | -                                                                                |
| contracts\study\Airfrop.sol                         | 0.00   | 0.00        | 21-33, 40-54, 59-69, 73                                                        | 21-23, 27-29, 31-33, 40-42, 45-47, 49-54, 60-62, 65-67, 69, 73                   |
| contracts\jobThree\Non-upgradable\PriceConsumer.sol | 0.00   | 0.00        | 41-42, 51-54, 62-63, 75-80, 89-105, 122-124, 133-139, 154-157, 174-181, 190,â€¦  | 52, 76, 90, 100-102, 135-139, 155, 175, 210-217, 222-229, 245-247, 250-252       |
| contracts\jobThree\Non-upgradable\NFTAuction.sol    | 0.00   | 0.00        | 176-177, 203-253, 268-292, 311-355, 369-458, 471-510, 523-524, 537-538, 549,â€¦  | 204-207, 210-212, 224, 270-274, 277-282, 313-317, 329, 333-344, 371-372, 374,â€¦   |
| contracts\jobTwo\BaseERC721.sol                     | 0.00   | 0.00        | 69-72, 79-82, 89-90, 97-98, 105-112, 127-134, 141-146, 153-157, 164-173,â€¦      | 387-410                                                                          |
| contracts\jobThree\PriceConsumer.sol                | 75.21  | 70.59       | 251-279                                                                        | 149-150, 203, 223, 258-265, 270-277                                              |
| contracts\study\Signature.sol                       | 0.00   | 0.00        | 19, 27-48, 61-66, 80, 89-95, 108, 116, 124, 161, 178-188, 206-209, 216-218,â€¦   | -                                                                                |
| contracts\jobThree\Non-upgradable\NFTERC721.sol     | 0.00   | 0.00        | 37-38, 47-48, 71-88, 98, 108                                                   | 77-88                                                                            |
| contracts\jobThree\NFTAuction.sol                   | 98.73  | 89.07       | 294-296, 642, 748                                                              | 309-311, 458, 469, 492-494, 496, 521, 564, 575, 586, 600, 631, 671, 681, 696     |
| contracts\study\DutchAuction.sol                    | 0.00   | 0.00        | 31, 38, 45, 50-70, 75-83, 88, 93, 98, 103-104                                  | 53, 55, 59, 62-66, 68-70, 75-83, 104                                             |
| contracts\jobTwo\VividNFT.sol                       | 0.00   | 0.00        | 49-63, 74-84, 89-101, 112-129, 136, 142, 148, 155, 162, 169, 179-188           | 81-84, 182-185                                                                   |
| contracts\jobThree\NFTERC721.sol                    | 100.00 | 100.00      | -                                                                              | -                                                                                |
| contracts\study\Study.sol                           | 0.00   | 0.00        | 8-9                                                                            | -                                                                                |
| --------------------------------------------------- | ------ | ----------- | ------------------------------------------------------------------------------ | -------------------------------------------------------------------------------- |
| Total                                               | 29.72  | 26.12       |                                                                                |                                                                                  |


